apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ configmap_name }}
  namespace: {{ namespace }}
  labels:
    app: madengine
    model: {{ model_name }}
data:
  build_manifest.json: |
{{ manifest_content | indent(4, first=True) }}
  credential.json: |
{{ credential_content | indent(4, first=True) }}
  {% if data_json_content %}
  data.json: |
{{ data_json_content | indent(4, first=True) }}
  {% endif %}
  {% if model_scripts_contents %}
  # Model scripts directory (all .sh, .py, and .json files from scripts folder)
  {% for script_path, script_content in model_scripts_contents.items() %}
  {{ script_path | replace("/", "-") }}: |
{{ script_content | indent(4, first=True) }}
  {% endfor %}
  {% endif %}
  {% if data_provider_script_content %}
  data_provider.sh: |
{{ data_provider_script_content | indent(4, first=True) }}
  {% endif %}
  {% if common_script_contents %}
  # Common scripts (pre_scripts, post_scripts) embedded since madengine not in container
  {% for script_path, script_content in common_script_contents.items() %}
  {{ script_path | replace("/", "-") }}: |
{{ script_content | indent(4, first=True) }}
  {% endfor %}
  {% endif %}

